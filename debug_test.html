<!DOCTYPE html>
<html>
<head>
    <title>Debug Test - PDF Quiz Generator</title>
</head>
<body>
    <h1>Debug Test Page</h1>
    <button onclick="testSampleFiles()">Test Sample Files API</button>
    <button onclick="testExtraction()">Test Extraction Start</button>
    <div id="output"></div>
    
    <script>
    function log(message) {
        console.log(message);
        document.getElementById('output').innerHTML += '<p>' + message + '</p>';
    }
    
    async function testSampleFiles() {
        log('üîç Testing sample files API...');
        try {
            const response = await fetch('/api/sample-files');
            const data = await response.json();
            log('‚úÖ Sample files response: ' + JSON.stringify(data, null, 2));
        } catch (error) {
            log('‚ùå Sample files error: ' + error);
        }
    }
    
    async function testExtraction() {
        log('üöÄ Testing extraction start...');
        try {
            const options = {
                useSamples: true,
                questionCount: "25",
                difficulty: "medium",
                includeContext: true,
                questionTypes: ["multiple-choice"]
            };
            
            const response = await fetch('/api/start-extraction', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(options)
            });
            
            const data = await response.json();
            log('‚úÖ Extraction response: ' + JSON.stringify(data, null, 2));
            
            // Check progress
            setTimeout(checkProgress, 1000);
            
        } catch (error) {
            log('‚ùå Extraction error: ' + error);
        }
    }
    
    async function checkProgress() {
        try {
            const response = await fetch('/api/extraction-progress');
            const data = await response.json();
            log('üìä Progress: ' + data.progress + '% - ' + data.message);
            
            if (data.status === 'processing') {
                setTimeout(checkProgress, 2000);
            } else if (data.status === 'completed') {
                log('üéâ Extraction completed!');
                testQuestions();
            } else if (data.status === 'error') {
                log('‚ùå Extraction failed: ' + data.message);
            }
        } catch (error) {
            log('‚ùå Progress check error: ' + error);
        }
    }
    
    async function testQuestions() {
        log('üìã Testing questions API...');
        try {
            const response = await fetch('/api/questions');
            const data = await response.json();
            log('‚úÖ Questions count: ' + data.total);
            if (data.questions && data.questions.length > 0) {
                log('First question: ' + data.questions[0].question.substring(0, 100) + '...');
            }
        } catch (error) {
            log('‚ùå Questions error: ' + error);
        }
    }
    </script>
</body>
</html>
